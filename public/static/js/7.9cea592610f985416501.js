webpackJsonp([7],{"H/xN":function(e,a){},vdVF:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("Dd8w"),c=t.n(s),n=t("6PdC"),o=t("oAV5"),i=t("mtWM"),r=t.n(i),d=t("T452"),u=t("NYxO"),l={name:"Login",data:function(){return{account:"",password:"",accountError:"用户名 / 邮箱不符合规范",passwordError:"密码至少包含数字、字母、符号中的两种",accountChecked:!0,passwordChecked:!0,cancelBlock:!1}},computed:c()({},Object(u.c)(["isLogin","username","token"]),{isNotEmpty:function(){return this.account&&this.password},isChecked:function(){return this.accountChecked&&this.passwordChecked}}),methods:c()({},Object(u.b)(["changeToken","changeUsername","changeLoginState"]),{clearAccountValue:function(){this.account="",this.accountChecked=!0},clearPasswordValue:function(){this.password="",this.passwordChecked=!0},validateAccount:function(){this.accountChecked=n.c.checkUsername(this.account)||n.c.checkEmail(this.account)},validatePassword:function(){this.passwordChecked=n.c.checkPassword(this.password)},getLogin:function(){var e=this;if(this.isNotEmpty&&this.isChecked){var a=n.c.getType(this.account),t=r.a.CancelToken.source();r()({url:d.a.baseUrl+"v1/token",method:"POST",data:{account:this.account,password:this.password,type:a}},{cancelToken:t.token}).then(function(a){e.$message({message:"登录成功",type:"success"});var t=a.data.token,s=a.data.username;localStorage.setItem("username",s),localStorage.setItem("token",t),e.changeToken(t),e.changeUsername(s),e.changeLoginState(!0),e.$router.push({name:"Home"})}).catch(function(a){e.$message({message:a.response.data.message,type:"error"})}),t.cancel()}else this.$message({type:"info",message:"请把相关信息填写完整"})},debouncedAccount:Object(o.a)(function(){this.validateAccount()}),debouncedPassword:Object(o.a)(function(){this.validatePassword()}),throttledLogin:Object(o.d)(function(){this.getLogin()},1e3)})},h={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"login"},[t("header",[e._v("欢迎登录")]),e._v(" "),t("ul",{staticClass:"input-box"},[t("li",{staticClass:"item username"},[t("span",{staticClass:"iconfont"},[e._v("")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.account,expression:"account"}],attrs:{type:"text",placeholder:"请输入用户名 / 邮箱"},domProps:{value:e.account},on:{input:[function(a){a.target.composing||(e.account=a.target.value)},e.debouncedAccount]}}),e._v(" "),t("transition",{attrs:{duration:500,"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.account.length>0,expression:"account.length > 0"}],staticClass:"iconfont cancel",on:{click:e.clearAccountValue}},[e._v("\n          \n        ")])]),e._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:!e.accountChecked,expression:"!accountChecked"}],staticClass:"error-message"},[e._v(e._s(e.accountError))])],1),e._v(" "),t("li",{staticClass:"item password"},[t("span",{staticClass:"iconfont"},[e._v("")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:e.password},on:{input:[function(a){a.target.composing||(e.password=a.target.value)},e.debouncedPassword]}}),e._v(" "),t("transition",{attrs:{duration:500,"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.password.length>0,expression:"password.length > 0"}],staticClass:"iconfont cancel",on:{click:e.clearPasswordValue}},[e._v("\n          \n        ")])]),e._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:!e.passwordChecked,expression:"!passwordChecked"}],staticClass:"error-message"},[e._v(e._s(e.passwordError))])],1)]),e._v(" "),t("div",{staticClass:"submit",on:{click:e.throttledLogin}},[e._v("登录")])])},staticRenderFns:[]};var p=t("VU/8")(l,h,!1,function(e){t("H/xN")},"data-v-0a6c2a19",null);a.default=p.exports}});
//# sourceMappingURL=7.9cea592610f985416501.js.map